{% load wagtailcore_tags core_tags i18n %}
<div class="col-12">
    {% if cart and cart.items.all %}
    <table id="table">
        <thead>
        <tr>
            <th><span>{% trans "Товар" %}</span></th>
            <th><span>{% trans "Кол - во" %}</span></th>
            <th><span>{% trans "Цена за товар" %}</span></th>
            <th><span>{% trans "Итоговая стоимость" %}</span></th>
        </tr>
        </thead>
        <tbody>
        {% for item in cart.items.all %}
        <tr>
            <td>{{ item.product.name }}</td>
            <td>
                <div class="item_quantity">
                    <button
                            type="button" class="quantity_minus"
                            hx-post="{% url 'cart:update-item' item.id 'minus' %}"
                            hx-swap="none"
                            hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                    >
                        <i class="nut-icon icons-qty-left"></i>
                    </button>
                    <input type="text" name="quantity" value="{{ item.quantity }}" readonly class="quantity_input">
                    <button
                            type="button" class="quantity_plus"
                            hx-post="{% url 'cart:update-item' item.id 'plus' %}"
                            hx-swap="none"
                            hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                    >
                        <i class="nut-icon icons-qty-right"></i>
                    </button>
                </div>
            </td>
            <td>{{ item.actual_price|floatformat:0 }} {% trans "грн." %}</td>
            <td>{{ item.item_total|floatformat:0 }} {% trans "грн." %}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="text-center popup__cart_clean">
        <p>{% trans "Ваша корзина пуста" %}</p>
    </div>
    {% endif %}
</div>
<div class="col-12">
    <div class="after_table">
        <div class="row">
            <div class="col-md-6">
                <a href="{% pageurl shop_page %}" class="button_transparent with_arrow">
                    <i class="nut-icon icons-left-arrow"></i>
                    <b>{% trans "Продолжить покупки" %}</b>
                </a>
            </div>
            {% if cart and cart.items.all %}
            <div class="col-md-6">
                <div class="popup__cart_sum">
                    <div class="sum_item">
                        <div class="sum_item_title"><p>{% trans "Всего" %} </p></div>
                        <div class="sum_item_new">
                            <p>{{ cart.cart_total|floatformat:0 }} <i>{% trans "грн." %}</i></p>
                        </div>
                    </div>
                    {% if request.user.is_authenticated and request.user.customer_profile %}
                    <div class="sum_item">
                        <div class="sum_item_button">
                            <a href="{% pageurl checkout_page %}" class="button">{% trans "Оформить заказ" %}</a>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
</div>
{% if not request.user.is_authenticated or  not request.user.customer_profile %}
<div class="col-12">
    <div class="no_log-in">
        <h2>{% trans "Для оформления заказа необходимо" %}</h2>
        <div class="no_log-in_link">
            <a href="{% pageurl login_page %}">{% trans "Авторизоваться" %}</a>
            <span>{% trans "или" %}</span>
            <a href="{% pageurl register_page %}">{% trans "Зарегистрироваться" %}</a>
        </div>
    </div>
</div>
{% endif %}